# Hello-Git

1.	引言
无线传感器网络（WSN，Wireless Sensor Network，WSN）是物联网（Internet of  Things，IoT）最重要的支撑技术之一。作为一项重要的信息获取技术，无线传感器网络极大地扩展了现有网络的功能，提高了人类对客观世界的认知能力，人类可以通过它直接感知外部世界[1].微机电技术、传感技术和节点间的无线通信能力为无线传感器网络赋予了广阔的应用前景，现已广泛应用于军事国防、国家安全、环境科学、交通管理、城市管理、生物医疗、智能城市建设和危险区域远程控制等许多领域[2].例如，在军事方面，无线传感器网络可以识别军队和装备，并且协调服务与作战。在生物医学方面，植入人体的医用传感器可以监测人体的健康状态，这也是无线传感器网络的一个典型的应用。在医疗保健方面，美国的CareNet项目，利用无线传感器网络对老年人的行动数据进行监测，实现了远程医疗保健的应用。在自然环境监测领域方面，为了监测大堡礁海域的生态系统情况，澳大利亚墨尔本大学和詹姆斯库克大学合作展开了（Great Barrier Reef, GBR）项目研究，成功利用无线传感器网络实现了海洋生态系统的监测和数据采集；中国海洋大学和香港科技大学合作开展的OceanSense项目，同样是面向海洋环境信息监测的无线传感器网络应用，并成功实现了对海洋环境信息数据的感知、实时采集和分析处理。在工业生产监测领域美国北卡罗来纳大学在肯塔基州的魁北克变电所部署的大规模无线传感器网络实现了对变电所设备的健康监测[3]。所以对无线传感器网络性能的研究与优化具有重要的理论与现实意义.一般情况下，无线传感器网络的覆盖范围不大，因此电磁波的传输时延可以忽略。大规模部署无线传感器网络的主要制约因素是无线传感器节点的处理，存储容量和能量的有限性。缓存容量足够大，避免数据丢失；处理速度足够快，达到控制传输时延的要求，尤其是对物联网中的一些实时数据。在一些特定的应用场合，WSN的性能格外受到重视，如森林火灾监控的数据传输、目标实时跟踪定位和天气、地质活动预测等对实时性要求高的应用场景，需要信息数据在传感器网络中的传输时延不能超过某个门限值，否则感知的数据还没被传送到终端用户处，就已经失去了参考的价值。另外，当传感器节点采用休眠/唤醒机制来节能时，信息的处理过程被限制在有限的工作时间内[4]。所以为了更有效地利用无线传感器网络，在分析无线传感器网络性能时引入排队理论显得非常有必要。
	排队网络对于评价网络的性能十分有用，并且可以作为一种维持无线传感器网络服务质量（QoS）的有效方式。传感器网络面临的主要挑战之一是对端到端时延的判断，它对实时应用的性能有很大的影响。排队论广泛地应用于分析无线传感器网络的传输时延，文献[5,6,7,8,9,10]假定分组的到达率或（和）服务率均服从泊松分布，队列长度为无限长，但是，由于现实中无线条件下存在着无处不在的干扰，这些猜想并不切实际。文献[11]利用排队论对多对一无线传感器网络进行建模，提出了一个G/G/1/K排队模型，并得到了其CSMA/CA MAC层协议模型下的封闭表达式，但是没有考虑任务之间优先级不同对端到端传输时延的影响。文献[12]研究了离散时间的Geom/G/1和M/G/1多重休假模型。文献[13]研究了传感器网络节点的流动性影响下的网络连通性，并利用GI/G/1/N排队网络建立了数学模型，分析了端到端平均传输时延、分组丢包率、吞吐率等性能指标。文献[14]提出了一个LLDA（Low-Latency Data Aggregation）模型，理论分析并仿真验证了该模型在提高无线传感器网络的性能，减少平均传输时延及降低丢包方面的优越性。在无线传感器网络性能的可靠性分析方面，文献[15]利用M/M/1/K队列对传感器节点进行建模，对无线传感器网络的实时可靠度进行了评价。相似地，文献[16]利用M/M/1/K队列，建模评估了分簇无线传感器网络的覆盖性和数据传输的可靠性。文献[17]利用排队论模型，提出了一种基于正则表达式的传感器网络性能评估方法。文献[18]使用了M/G/1/K排队模型，研究了传感器簇中的节点的表现。文献[14]提出了基于优先级排队的多任务网络数据处理模型，并推导出服务质量的理论公式，包括平均队长，传输时延与抖动。
	本文在文献[14]所做研究的基础上，继续研究无线传感器网络节点的性能。考虑到传感器节点的能量受限，引入了MAC层的一种周期休眠机制，并将节点处理转发数据的过程分为计算和通信两个阶段；针对传感器网络节点可能存在的数据拥塞问题，引入RED算法进行拥塞控制，在理论分析的基础上进行了实验仿真。 
	本文的剩余部分组织如下：第二部分介绍了排队论相关的基本概念；第三部分从理论层面对无线传感器网络进行了分析；第四部分对理论模型做了实验设计和仿真分析。最后，第五部分是结论。
2.	相关基本概念
排队论（Queuing Theory）又名随机服务理论，是研究排队与拥挤现象的一门数学学科.利用排队理论，可以精确地研究分组的到达、服务与离开的过程.为了研究基于排队论的无线传感器网络模型，下面对一些基本概念加以说明.
1.	输入过程
输入过程描述顾客来源及顾客是按照怎样的规律到达系统.如果设 表示第 个(批)顾客的到达时刻，则
	 
又令 ，则 表示第n个(批)顾客到达时刻与第n-1个(批)顾客到达时刻之差，称序列 为顾客相继到达的间隔时间序列.在排队论研究中，一般假定 相互独立、同分布.如果 独立、同负指数分布，则输入过程 是最简单流(Possion流).
2.	排队规则
排队规则指的是到达节点的分组按照某种规定好的方式决定接受服务的先后顺序.最常用的服务规则为先到先服务(FCFS).
3.	服务机构
刻化服务机构的主要方面为：①服务台的数目.多个服务台的情况下，是串联还是并联；②服务时间分布 :在服务过程中，设分组 的服务时间为 ，假定每个分组接受的服务是独立的，则 是独立的随机序列，记为 .
4.	分组到达率 
单位时间内到达网络节点的分组的平均数量，反映了分组到达节点的快慢. 是分组的平均到达时间间隔.
5.	网络节点的服务率 
单位时间内经过服务的分组离开节点的平均数量，反映了服务的快慢. 表示网络节点中分组的平均服务时间.
6.	服务强度 
单位时间内每个节点的平均服务时间， 是反应网络节点繁忙程度的重要指标.

3.	WSN节点排队模型研究
3.1	M/M/1节点排队模型研究
	在无线传感器网络中，分组不间断地到达节点，因此，可以认为分组的数量是无限的.为了简单起见，对于无线传感器网络中的单个节点，可以认为节点的工作过程符合M/M/1经典排队模型，也就是，分组到达节点的过程是参数为 的Possion流，即到达的时间间隔序列 独立且服从参数为 的负指数分布 ；节点服务模块的服务过程独立于分组的输入过程，服务时间序列 满足参数为 的负指数分布 ；节点排队系统中有一个服务台，允许无限长排队.为了便于分析，可以将传感器节点的工作过程简化为如图所示的一个简单排队模型.
 
图3-1 WSN节点M/M/1排队模型
	 表示 内到达系统的顾客数，可以证明， 是传感器节点上的分组数的生灭过程.下面给出几个重要的数量指标.
首先建立含 的方程组求状态概率 ，因为 只能是非负整数，而 是连续变量，所以建立的有关状态的方程组一般属微分方程，其解是瞬态性质，不容易求解.因此，我们常取统计平衡下的稳态解，即 .根据参考文献[20]可知，当 时， 存在，得：
	 
	 
1）	系统平均队列长度（分组数期望值）
 
2）排在队列中的平均分组数
 
3）分组平均等待时间
统计平衡下( )，分组排队等待的时间分布为
      
则平均等待时间为
 
4）分组平均逗留时间
由于服务率是 ，故每一分组接受服务的平均时间为 ，因此，分组在系统中的平均逗留时间为
	 
其方差（时延抖动）为
	 
3.2	带优先权的节点排队模型研究
本文考虑包含两个顾客等级的情况，采用的是具有两个优先级等级的强拆型M/M/1系统.图中到达节点缓存队列的分组分为两类，缓存队列带有调度机制对下一个即将进入服务模块的分组按优先级进行调度.当优先分组进入系统时，若服务模块空闲且无其他优先分组在排队，则直接进入服务模块进行处理，若服务模块忙，高优先级顾客的到达会立即打断当前的服务，并随之让自己接受服务
 
图3-2 带优先级的WSN节点排队模型
如图，有两类分组输入，第一类、第二类分组独立地分别按参数 和 的Possion流到达. 两类分组的服务时间分别遵从参数为 和 的负指数分布，且第一类有强拆型的优先权，到达与服务是独立的，它们到达的数量比率分别表示为 以及 .假定系统在时刻 的状态 ，若此时系统中有 个优先分组和 个普通分组. 容易证明 为生灭过程.可以把上述参数表示成： 和 ，即 .在此系统中，系统能够达到统计平衡的条件是：
 
令 ，则当系统处于统计平衡时，有平衡方程
	 
其中 ，解方程组的过程可以参考文献[20]，其中通过一个母函数
	 
的反演求解 ，式中
	 .
解出
	 . 
令 与 分别表示系统中有 个第一类顾客与 个第二类顾客的概率，而他们的概率母函数分别为 和 . 于是，在 中，令 ，使用洛必达法则，得
	 ，
因而
	 .
这结果与只有一类以 为参数的Possion流输入、服务时间是参数 的负指数分布的单服务台等待制M/M/1系统的结果相同，也就是说第二类顾客的存在对具有强拆优先权的第一类顾客来说不发生任何影响。此时，
	 ，
	 .
且第一类顾客的平均等待时间和逗留时间分别为
	 ,
	 
抖动
	 
	另外，
 .
	与上述情况不同，第一类顾客的存在对系统中第二类顾客数目的分布是有影响的. 此时上式对 求导，然后令 ,即可求得第二类顾客的平均数
	 .
因此，第二类顾客的平均逗留时间为
	 
                                    
3.3 可休假的两服务模块节点排队模型研究
1）WSN休眠机制
无线传感器网络的节点能量由能量有限的微型电池供给，由于电池能量有限且难以更换，节点的失效又容易破坏网络拓扑，所以怎样尽可能的降低节点能耗成为了无线传感器网络研究中的重点和难点.能耗问题涉及的范围很广，几乎和每一协议层都相关，研究起来十分复杂；本章只简单考虑MAC层的一种节能机制——周期休眠机制（图3-3）.
 
图3-3 周期的工作/休眠机制
周期休眠即节点周期性的关闭服务模块，不再接收来自队列的分组，实际中很多时候节点都处于空闲状态，因此周期休眠将大大降低能耗.与此同时，服务模块的休假会造成分组传输时延的增加，时延受占空比（活跃时间占周期的比例）的影响.
2）随机分解原理[21]
随机分解是研究休假排队理论的重要工具.通常可将系统稳态下的性能指标分解为两部分之和，一部分是无休假的经典排队系统中的指标，另一部分是休假期造成的系统指标附加量.借助随机分解原理，可以清楚的认识到休假排队系统与经典排队系统之间的关系，以便研究不同休假策略影响下，经典排队系统的性能变化过程.总的来说，随机分解的优势在于将对休假模型的研究简化为对附加值的研究.
以 ， ， 分别表示平稳状态下系统中的总分组数、排队等待的分组数及分组平均等待时间.当系统加入某种休假策略后，用 ， ， 表示休假排队系统中相关的性能指标.则随机分解的结果可表示为：
	 
式中， 和 称为分组队长的附加量， 称为分组延时的附加量.
3.3.1分组串联服务排队模型描述
在实际工作的无线传感器网络中，存在这样一种工作情况：数据分组（主要来自自身感应）到达某个传感器节点时，先要经过处理器模块的计算，然后再被送到通信模块进行发送，形成一种串行服务模式.针对这一工作模式，考虑传感器网络中一个普通的中间节点，分组到达该节点要经历两阶段服务，两个阶段分别对应于在处理器模块的计算阶段和在通信模块的通信阶段.另外，在模型中增加一个能够控制服务模块周期通断的开关装置，以达到节点周期休眠的目的.由此建立的WSN节点服务模型如图3-4.
图3-4中的周期休眠模块控制整个系统的通断，通则表示节点正常工作，断则表示节点进入休眠状态，占空比影响系统的性能.假设节点中的计算模块和通信模块分别对应串联排队中的两个服务台，提供计算和通信两阶段服务.两服务台前均允许分组排队等待且等待空间无限大，输入系统的分组是参数为λ的泊松流，数据分组先在计算模块接受服务，完成第一阶段的服务后进入发送模块，在发送模块服务完成后自行离开节点系统.两个服务阶段的服务时间相互独立且服从参数为 、 的负指数分布.
 
图3-4 可休假的WSN节点串联服务排队模型
3.3.3分组并联服务排队模型描述
考虑这样一种节点工作情况：到达节点的所有分组可通过两条路径进入系统，其中一部分是节点作为某条路由路径中的中继节点，仅对邻居节点发送来的数据分组进行存储转发，无需经过计算模块；另一部分是节点对自身感应采集的数据提供的本地服务，当分组到达节点后，先要经过数据融合、编码、路由等计算处理之后，才能并入通信模块进行发送.在模型设计时，进入节点的分组经过简单的路径判断后，一部分直接进入通信模块，另一部分先经过计算模块处理之后，再汇入通信模块.这样，便形成了一种两路分组并联处理的工作模式.具体模型如图3-5.
 
图3-5 可休假的WSN节点并联服务排队模型
为了符合传感器节点工作特点，图3-5中保留了周期休眠装置.两个服务台代表了通信模块和计算模块，且允许无限排队.分组以参数为 的泊松流输入节点，经过简单的路径判断后进入合适的路径接受服务，两服务模块的服务率 、 与串联模型中的相同.
3.3.4相关指标分析
1）节点休眠对性能指标的影响
本节仅对休假给系统带来的影响进行定性分析，为了分析方便，仅考虑在经典的M/M/1排队模型中加入某种休假策略，不考虑休假终止的策略，分析的定性结果同样适用于带周期休眠机制的节点服务系统.
当系统空出时，服务设备进入休眠状态，当休眠时间结束且节点重新进入工作状态时，系统的缓存队列中已经有一定的数据分组在排队等待，以 表示自休假开始至下一次工作开始的期间里进入系统的分组数.对于经典的M/M/1排队模型， ；对于休假排队系统， 是一随机变量
	 
	以 表示带休假的M/M/1节点排队系统在时刻 的分组数目， 表示在第 个分组的离开时刻留在系统中的分组数，则 是分组数增消过程 的嵌入Markov链.休假系统在忙期的运行与无休假系统没有区别，在间隔的离去时刻节点系统中的分组数存在如下关系
	 
其中， 是在一个分组的服务周期内输入节点系统的分组数.有概率分布
	 
由3.3.1节中介绍的随机分解定理可知，当 时，统计平衡下的节点休假排队系统的分组队长可分解成两部分之和： ，其中 是经典M/M/1排队系统稳态下的队长，附加的队长 是离散随机分布 的“剩余寿命”.此处，不加证明的引用
	      
	                                                                                                                                                                             
同样，分组在系统中等待的时间 可分解为如下形式： ，其中W是经典M/M/1排队系统的稳态下的分组等待时间， 是延迟附加值，引用如下公式
	 
	                                                                                                                                                                           
具体证明过程可见参考文献[21].
通过上述分析可见，节点服务系统加入休眠机制后，系统稳态下的队列长和时延都会增加一个附加值，这个附加值是由休假开始到结束这段时间内系统中积累的分组数所造成的.且对于附加的延迟 ，分组到达率 值越大，附加的延迟也越大.
2）节点两服务台串联排队系统分析
WSN节点串联排队系统由两个等待制的服务设备串联而成.计算模块的输出过程是发送模块的输入过程，由参考文献[20]可知，统计平衡下的M/M/1的输出过程仍然是参数λ的负指数分布，即顾客离开是泊松流，所以发送模块也构成了一个M/M/1排队系统.于是，节点的两阶段串联服务过程构成了一个M/M/1→M/M/1排队系统.
设时刻 在计算模块前等待和正在接受服务的分组总数为 ,在发送模块的分组总数为 ，则 为系统在状态空间 上的生灭过程.
令
	 
其中 分别为计算和发送模块的分组数.
显然，时刻 系统中分组数 是一个Markov过程，由极限定理[20]可知存在稳态解，即
	 
引用文献[20]，得
	 
其中， ，且 ..
由上式可以看出，一个串联的节点排队系统M/M/1→M/M/1的稳态分布等于两个服务模块单独的稳态分布的乘积.
根据相关排队理论，可得如下结论：
（1）排队容量无限的两服务设备串联排队系统的平均队长为 
	 
平均等待队长为
	 
（2）由于计算模块等同于M/M/1排队模型，所以分组在该模块的等待时间为
	 
同样，发送模块处的分组等待时间为
    
又因为两服务阶段的等待时间 和 相互独立，所以整个节点串联排队系统的分组等待时间为
	                                               
因此，平稳状态下，排队容量无限的两服务台串联排队系统的平均等待时间为
	  
由式可清楚的看出，系统的平均等待时间由两部分组成，分别对应计算阶段和发送阶段的等待时间，且均符合M/M/1模型下的顾客平均等待时间的表达式.
在上式的基础上，加上分组在两个模块中被服务的时间 和 ，可得平均逗留时间为
	 
经过上面分析过程所得的公式的证明可见参考文献[22].
3.4 基于RED的WSN节点排队模型
RED算法，即随机早期检测算法(Random Early Detection)[23]，是用于缓解网络拥塞现象的队列管理机制，一般的用法是通过长期观察平均队长，将其和预设的阈值相比较，若满足了特定的条件，就在提前开始以随机概率来丢包.因为这个算法具备着较低的时延特性、较高的吞吐量以及较优的公平性，所以它被广泛的采用以改善、解决拥塞现象.对于RED算法来说，它所关注的主要指标是丢包率以及时延.这两个指标越小，就说明系统性能越好.
一般的，RED算法会按照下面的步骤来实现：事先预设两个阈值（一个下限 以及一个上限 ）；计算出平均队长后与上下限进行比较；当它在两阈值之间的时候，就以概率 来随机丢弃即将到达的数据分组；当它小于下限的时候，还不存在拥塞现象或程度比较轻，就将 置零，不去丢弃即将到达的任何一个数据分组；当它大于上限的时候，此时拥塞现象已经非常严重了，就将 置1，要丢弃即将到达的所有数据分组.
下面介绍RED算法的主要指标：
（1）平均队长
RED算法采用了指数加权动态均值的方法来计算平均队长，其一般表达式如下：
	 
式中， 代表平均队长， 代表权值， 代表采样时刻的瞬时队列长度。
这种方式类似于低通滤波器的原理.由于上述表达式采用了加权值来计算，它可以避免平均队长被突发性因素的产生而被过分地影响，过滤了瞬时或短期的队长变化，从而达到在长时间跨度上的观察效果.
（2）丢包率
前一步计算出平均队长后，就能根据其结果来计算丢包率，对当前的拥塞状况采取合理的措施.
一般的，计算丢弃概率 的表达式如下：
	 
	 
式中， 代表标记概率； 代表从上一次丢包开始到当前时刻未被丢弃的数据包个数； 代表最大丢弃概率.
不难分析出： 如果在增大，那么下一个包会被丢弃的概率也会随之增大； 最好大于两次计算间隔时间内平均队长的增加值.这样一来就可以解决连续丢包的问题，让丢包现象发生地更加均匀，以便改善和减轻全局同步的现象，使算法更加合理.
3.4.1 基于RED的WSN节点M/M/1排队模型
考虑到在真实的网络情况中，在通信的高峰时期会出现数据拥堵严重的情况，这对系统性能会造成很大的影响.所以为了改善拥塞现象，需要对WSN节点M/M/1/∞排队模型优化，加入RED算法模块.此时WSN节点的排队流程可用下图表示：
 
图3-6 基于RED的WSN节点M/M/1排队模型
数据分组按照泊松过程到达后，进入排队队列等待.若负载较轻，RED算法不启动，但当通信高峰到来即高负载，并到达了设定的阈值时，RED算法就会开始启动.对所有即将到来的分组进行以概率的预丢包，借此来控制缓解拥塞现象的发生，降低节点的工作压力，使其工作效率得到提高.
3.4.2 基于RED的具有优先级节点排队模型
本节中将3.2与3.4的模型整合在一起，得到基于RED的具有优先级WSN节点M/M/1/∞排队模型.它不但具有两类优先级分组，还搭配上了RED算法，能适应更复杂的网络情况.此时WSN节点的排队流程可用下图表示
 
图3-7 基于RED的具有优先级节点排队模型
数据分组先要经过优先级分类之后，形成高低优先级两类，再分别以不同参数的泊松过程到达排队同一个队列进行等待.若负载较轻，RED算法不启动，当到达高负载状态，并且超过了设定的阈值时，RED算法就会启动.对所有即将到来的高低优先级分组进行以相应的概率分别预丢包，借此来控制拥塞现象的发生，降低节点的工作压力，使其工作效率得到提高.对其的设定是这样的：理想队长为 ； ；当 时，RED开始启动运行：运行时对高优先级分组的丢弃概率 ；运行时对低优先级分组的丢弃概率 .
4 实验设计与结果分析
4.1 M/M/1节点排队模型
1） 均固定
设定分组到达率 ，系统服务率 ，则服务强度 。
（1）	测定节点服务模块的利用率(服务强度)
 
图4-1 服务器模块利用率
（2）测定节点缓存队列中平均等待的分组数
根据第3章中的M/M/1系统稳态分析可知，平均等待队列长为：
	 
 
图4-2 排队等待的平均分组数
（3）测定分组在节点中的平均逗留时间
根据第3章中的M/M/1系统稳态分析可知，分组平均逗留时间为：
 
 
图4-3 分组平均逗留时间
2）μ固定，λ改变
设定节点服务设备的服务率为 ，分组的到达率λ可以在 之间改变，取不同的5个 值，但始终保持 ，观察分组到达率的改变对系统的分组逗留时间的影响，仿真时间设置为1000s。仿真结果如图所示。
由图可以看出，当系统的服务率固定不变时，随着分组到达率的增大，即分组到达系统的速度越来越快，系统中分组的平均逗留时间也越来越长。尤其当 大于0.6之后，时延的增长愈发明显。
 
图4-4 不同输入率下的分组平均逗留时间
3） 改变， 固定
设定系统的分组输入率 ，系统服务率取5个不同的值，但始终保持 ，观察系统服务率的改变对分组逗留时间的影响，仿真持续时间设置为1000s。仿真结果如图所示。
 
图4-5 不同服务率下的分组平均逗留时间
由图可以看出，当分组到达率固定不变时，随着系统服务率的减小，即系统服务的速度越来越慢，系统中分组平均逗留的时间变得越来越长。因此，对于传感器节点而言，其服务模块的服务能力对分组的平均传输时延影响较大，服务能力越强，分组的平均时延就越小。
4.2 带优先权的节点排队模型
在带优先权的节点排队系统中，令 ，设置 ，则 ，仿真时间设定为1000s。仿真结果如图。
 
图4-6 优先权对系统平均逗留时间的影响
	由仿真结果可以看出，在满足统计平衡的条件下，低优先级的哪一类分组的平均逗留时间要比高优先级（具备强拆特性）分组大得多。这就说明，前者的分布会因后者的存在而受到严重影响。
下面给出高优先级分组与无优先级的M/M/1/∞排队模型中分组之间在逗留时间上的比较（两者参数 与 设置相同）：
 
图4-7 低优先级分组对高优先级分组的影响
可以看出，由于参数设置完全一致，两者完全重合。这就说明了，高优先级（具备强拆特性）分组的分布不会受到低优先级那一类分组的影响，并且与同参数的M/M/1中分组的分布一致。

4.3 带休假的节点排队模型
4.3.1 串联排队模型
设定系统的分组输入率 ，计算模块的服务率 ，发送模块的服务率 ，则两服务台的服务强度分别为 ， 。两个队列的等待容量均设定为无穷大，脉冲产生器的一个周期内的脉冲长度可根据需要进行调节。
1）休眠对串联模型分组时延的影响分析
本文只针对所建立的两阶段服务的节点排队系统，研究节点休眠给性能带来的影响，但由于只做定性的分析，所以分析结果并不失一般性。
周期性的休眠机制必将延长分组在系统中的逗留时间，我们一般研究一个周期中系统处于工作状态的时间占总时间的比例，即占空比对分组时延的影响。
设定仿真时间为1000s，取10s为一个周期，调节一个周期内脉冲的占空比，取5组不同的值，观察休眠时间对分组时延的影响。仿真结果如图。
由图可以看出，当节点大部分时间（60%以上）处于工作状态时，分组在系统中的平均时延只随休眠时间的增加作微小的增加；但是当节点在一个周期内休眠占50%以上的时间时，系统的分组平均时延会急剧增长，严重影响了感知数据的实时性。
 
图4-8 占空比对串联排队模型分组时延的影响
2）系统分组时延分析
为了验证所建模型的合理性，对串联排队系统的分组平均时延进行了测量。设定模型中外加脉冲的占空比为100%，即不考虑节点休眠，其他系统参数均保持不变。为了测定稳态下的分组时延，设定仿真时间40000s。仿真结果如图所示。
根据3.3.1中对串联排队系统的性能分析，可知分组在节点中的平均延时为
	 
将仿真时设定的 代入公式，经过计算得 。由图的仿真结果可见，节点的串联排队系统的分组时延仿真值与理论值很接近，所以该模型的建立是合理且正确的。
 
图4-9 节点串联排队模型的分组平均时延
4.3.2 并联排队模型
1.	并联模型实验分析
为了便于两种不同工作方式下的系统性能指标的分析和比较，将分组输入率和两服务模块的服务率的值与串联模型保持一致，各个队列的容量均无穷大。
1）休眠对并联模型分组时延的影响分析
假定某段时间内有30%的分组需要直接转发，其余70%的分组需要计算处理后转发，则 的值设为0.3。
此处，分析周期休眠机制下占空比对并联模型时延的影响。设定仿真时间为1000s，取10s为一个周期，调节一个周期内脉冲的占空比，取5组不同的值，观察休眠时间对分组时延的影响。仿真结果如图。
 
图4-10 占空比对并联排队模型分组时延的影响
由图可以看出，占空比对分组时延的影响十分明显，占空比越大，即节点一个周期内工作的时间越长，分组时延就越小。对比图可以发现，相同的休眠时间下，串联模型的时延要比并联模型的时延大。因此，当节点中大部分分组都来自于自身感应采集时，应该尽可能的控制休眠的时间；而当只需转发的分组占据多数时，可以适量增加节点休眠的时间。这样，可以对节点工作时的能耗和分组时延进行权衡。
2）系统分组时延分析
分析节点并联工作方式下分组的平均时延，并与串联工作的情况进行比较。与串联模型测定分组时延的实验一样，本实验中也不考虑节点休眠的影响。分别取 ，对应并联模式下可能出现的两种极端情况，对比串、并联工作方式下的分组时延，并观察 的大小对时延的影响。仿真结果如图。
 
图4-11 节点并联排队模型的分组平均时延
由图可知，当 时，即大部分到达节点的分组都要先经过计算模块时，分组的时延与串联模型的时延很接近，此时的并联模型也几乎等同串联模型；当 时，即多数分组来自邻居节点时，并联模型的分组时延明显降低。因为节点并联工作方式下，只有部分分组需要接受两个阶段的服务，这样无需进行计算的那部分分组便节约了时间，分组时延势必会比串联模型有所减少。因此，并联工作模式具有更高的分组处理效率，性能更佳。
4.4 基于RED的节点排队模型
4.4.1 基于RED的M/M/1排队模型
下面列出部分仿真结果：
（1） 
 
图4-12  平均等待时间对比
 
图4-13  平均等待队长对比
 
图4-14  丢包率
由以上的图示结果可以看出，在重负载的情况下，RED模块起到了良好的降低拥塞现象的效果，使得平均等待时间与平均等待队长都得到了控制，最终系统都能进入到统计平衡的状态，丢包率也从开始的较大波动逐渐稳定下来。

4.4.2 基于RED的具有优先级的节点排队模型
同参数下，列出部分实验结果与不采用RED算法的优先级模型的相比：
（1） 
 
图4-15  逗留时间对比
 
图4-16 采用RED算法的不同优先级分组的丢包率
由以上的图示结果可以看出，采用RED算法对低优先级分组的逗留时间有较大的影响，让其有了大幅度的降低；而对高优先级分组逗留时间则影响比较小，只让其有些许的下降。而从丢包率的角度来看，低优先级总是比高优先级要丢掉更多，这就是为什么RED算法对它影响较大的原因。可以说，本模型起到了良好的优化作用，完成了实验的目标。
5 结论
参考文献
[1]任丰原,黄海宁,林闯. 无线传感器网络[J]. 软件学报,2003,(07):1282-1291. [2017-09-08]. DOI：10.13328/j.cnki.jos.2003.07.013
[2] I. F. Akyildiz, W. Su, Y. Sankarasubramaniam, and E. Cayirci,“Wireless sensor networks: a survey,” Computer Networks, vol.38, no. 4, pp. 393–422, 2002
[3]洪锋,褚红伟,金宗科,单体江,郭忠文. 无线传感器网络应用系统最新进展综述[J]. 计算机研究与发展,2010,47(S2):81-87. [2017-09-08]. 
[4] S. Lall, A. S. Alfa and B. T. Maharaj, "The role of queueing theory in the design and analysis of wireless sensor networks: An insight," 2016 IEEE 14th International Conference on Industrial Informatics (INDIN), Poitiers, 2016, pp. 1191-1194. doi: 10.1109/INDIN.2016.7819347
[5] N. Bisnik and A. Abouzeid. Queuing network models for delay analysis of multihop wireless ad hoc networks. In Proceedings of the 2006 international conference on Wireless communications and mobile computing, IWCMC’06, pages 773–778, 2006.
[6] Y.-C. Chen, J. Kurose, and D. Towsley. A simple queueing network model of mobility in a campus wireless network. In Proceedings of the 3rd ACM workshop on Wireless of the students, by the students, for the students, pages 5–8. ACM, 2011.
[7] Y.-C. Chen, J. Kurose, and D. Towsley. A mixed queueing network model of mobility in a campus wireless network. In INFOCOM, 2012 Proceedings IEEE, pages 2656–2660. IEEE, 2012.
[8] J. Hu, G. Min, M. E. Woodward, and W. Jia. Analytical modelling of ieee 802.11 e enhanced distributed channel access protocol in wireless lans. In Performance Models and Risk Management in Communications Systems, pages 173–190. Springer, 2011.
[9] R. Khalaf, I. Rubin, and J. Hsu. Throughput and delay analysis of multihop IEEE 802.11 networks with capture. IEEE International Conference on Communications, 2007. ICC ’07., pages 3787 – 3792, 2007.
[10] Z. Zhou and Y. Zhu. Computational analysis of (map1, map2)/(ph1, ph2)/n queues with finite buffer in wireless cellular networks. Systems Engineering and Electronics, Journal of, 22(5):739–748, 2011.
[11] B. Zhang, W. Cheng, L. Sun, X. Cheng, T. Znati, and M. A. A. Al-Dhelaan, “Queuing modeling for delay analysis in mission oriented sensor networks under the protocol interference model,” in Proc. Int. Workshop on Mission-oriented wireless sensor networking, 2013, pp.11–20.
[12] T. M. Nagendrappa and F. Takawira, “Queuing analysis of distributed and receiver-oriented sensor networks: distributed DS-CDMA-based medium access control protocol for wireless sensor networks,” IET Wireless Sensor Systems, vol. 3, no. 1, pp. 69–79, Mar. 2013.
[13] R. B. Lenin and S. Ramaswamy, “Performance analysis of wireless sensor networks using queuing networks,” Annals of Operations Research, pp. 1–25, Nov. 2013.
[14] M. Kamarei, M. Hajimohammadi, A. Patooghy, and M. Fazeli, “An Efficient Data Aggregation Method for Event-Driven WSNs: A Modeling and Evaluation Approach,” Wireless Personal Communications, pp. 1–20, May 2015.
[15] K. Mizanian, H. Yousefi, and A. H. Jahangir, “Modeling and evaluating Reliable Real-Time degree in multi-hop Wireless Sensor Networks,” in Proc. IEEE Sarnoff Symposium, 2009, pp. 1–6.
[16] H. Yousefi, K. Mizanian, and A. H. Jahangir, “Modeling and Evaluating the Reliability of Cluster-Based Wireless Sensor Networks,” in Proc. IEEE Int. Advanced Information Networking and Applications, 2010, pp. 827–834.
[17] J. Wang, K. Cui, K. Zhou, and Y. Yu, “Based on Regular Expression Matching of Evaluation of the Task Performance in WSN: A Queue Theory Approach,” The Scientific World Journal, pp. 1–9, Oct. 2014.
[18] J. Misic, S. Shafi, and V. B. Misic, “Maintaining Reliability Through Activity Management in an 802.15.4 Sensor Cluster,” IEEE Trans. Veh. Tech., vol. 55, no. 3, pp. 779–788, May 2006.
[19] Hongsheng Yin, Honggang Qi, Jingwen Xu,Xin Huang, and Anping He, “An Efficient Multitask Scheduling Model for Wireless Sensor Networks”, Journal of applied mathematics, DOI: 10.1155/2014/969523,2014
[20] 唐应辉，唐小我. 排队论-基础与分析技术[M]. 北京：科学出版社，2006:35-84
[21] 田乃硕. 休假随机服务系统[M]. 北京: 北京大学出版社，2001:41-49
[22] 刘海芳. 两服务台串联排队系统[D].中南大学，2007.10:14-29
[23] 陈新房. 基于RED算法的拥塞控制策略研究[D].大连海事大学,2008.

